<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@include file="/common/taglib.jsp"%>
<c:url var="newAPI" value="/api/role" />
<c:url var="newURL" value="/quan-tri/vai-tro/danh-sach" />
<!DOCTYPE html>
<html>
<head>

</head>
<body>
<div class="mobile-menu-overlay"></div>
<div class="main-container">
	<form action="<c:url value='/quan-tri/vai-tro/danh-sach'/>" id="formSubmit" method="get">
		<div class="pd-ltr-20 xs-pd-20-10">
			<div class="min-height-200px">
				<div class="page-header">
					<div class="row">
						<div class="col-md-6 col-sm-12">
							<div class="title">
								<h4>Roles</h4>
							</div>
							<nav aria-label="breadcrumb" role="navigation">
								<ol class="breadcrumb">
									<li class="breadcrumb-item"><a href="index.html">Home</a></li>
									<li class="breadcrumb-item active" aria-current="page">Roles</li>
								</ol>
							</nav>
						</div>
					</div>
				</div>
			</div>
			<div class="card-box mb-30">
				<div class="pd-20">
					<h4 class="text-blue h4">Roles</h4>
				</div>
				<div class="pb-20">
					<table class="data-table table stripe hover nowrap">
						<thead>
							<tr>
								<th>
									<input type="checkbox" id="checkAll">
								</th>
								<th class="table-plus datatable-nosort">Name</th>
								<th>Code</th>
								<th class="datatable-nosort">Action</th>
							</tr>
						</thead>
						<tbody>
							<c:forEach var="item" items="${model.listResult}">
							<tr>
								
								<td>${item.name}</td>
								<td>${item.code}</td>
								<td>
									<div class="dropdown">
										<a class="btn btn-link font-24 p-0 line-height-1 no-arrow dropdown-toggle" href="#" role="button" data-toggle="dropdown">
											<i class="dw dw-more"></i>
										</a>
										<div class="dropdown-menu dropdown-menu-right dropdown-menu-icon-list">
											<a class="dropdown-item" href="#"><i class="dw dw-eye"></i> View</a>
											<a class="dropdown-item" href="#"><i class="dw dw-edit2"></i> Edit</a>
											<a class="dropdown-item" href="#"><i class="dw dw-delete-3"></i> Delete</a>
										</div>
									</div>
								</td>
							</tr>
						</c:forEach>
					</tbody>
				</table>
				<div class="row">
					<div class="col-md-4 col-sm-12"></div>
					<div class="col-md-4 col-sm-12">
						<ul class="pagination" id="pagination"></ul>
						<input type="hidden" value="" id="page" name="page" /> 
						<input	type="hidden" value="" id="limit" name="limit" />
					</div>
					<div class="col-md-4 col-sm-12"></div>
				</div>
			</div>
		</div>
	</div>
</form>
</div>
	<content tag = "script">
	<script>
		var totalPages = ${model.totalPage};
		var currentPage = ${model.page};
		$(function() {
			window.pagObj = $('#pagination').twbsPagination({
				totalPages : totalPages,
				visiblePages : 10,
				startPage : currentPage,
				onPageClick : function(event, page) {
					if (currentPage != page) {
						$('#limit').val(5);
						$('#page').val(page);
						$('#formSubmit').submit();
					}
				}
			});
		});

		// xoa
		function warningBeforeDelete() {
			swal({
				title : "Xác nhận xóa",
				text : "Bạn có chắc chắn muốn xóa hay không",
				type : "warning",
				showCancelButton : true,
				confirmButtonClass : "btn-success",
				cancelButtonClass : "btn-danger",
				confirmButtonText : "Xác nhận",
				cancelButtonText : "Hủy bỏ",
			}).then(function(isConfirm) {
				if (isConfirm) {
					var ids = $('tbody input[type=checkbox]:checked')
						.map(function() {
							return $(this).val();
							}).get();
						deleteNew(ids);
					}
			});
		}
		function deleteNew(data) {
			$.ajax({
				url : '${newAPI}',
				type : 'DELETE',
				contentType : 'application/json',
				data : JSON.stringify(data),
				success : function(result) {
					window.location.href = "${newURL}?page=1&limit=5&message=delete_success";
				},
				error : function(error) {
					window.location.href = "${newURL}?page=1&limit=5&message=error_system";
					}
			});
		}
	</script>
	</content>
</body>
</html>